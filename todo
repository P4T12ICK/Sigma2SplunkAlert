
Alert Workflow:
- Load Sigma2SplunkAlert Configuration
- Load all rules with extension .yml
- Check if rules is a sigma rule
- For every N input
- For every Sigma File
- Load Sigma File
- Convert Sigma File to Splunk Search
- Add Host Field to Search Command (optional) (Splunk Search Manipulation) (only if table exists)
- Add Transformin Command if there is no table command
- Add Whitelist Command at the end (optional) (remove the generation of Lookups)
- Generate Email as Action
- Summary Index support (collect command for Alert, Summary Index Values for Report)
- Create UseCase Object
- Build savedsearches.conf with Jinja2



New Config File:

scheduled_search: 'report' -> to do
app: 'sigma_hunting_app'
cron_schedule: '*/10 * * * *'
earliest_time: '-10m'
latest_time: 'now'
schedule_window: auto	#New Option
search_transformations:	# implement in a way that everyody can write an extension
    - transforming_command
    - add_host_field
    - add_whitelist
alert_action:
    summary_index:
        name: 'threat-hunting'
	      enrich_tags: 1
        enrich_level: 1
    email:       # remove value with 0 from the config
        to: 'test@test.de'
        subject: 'Splunk Alert: $name$'
        message: 'Splunk Alert $name$ triggered %mitre% |List of interesting fields:  %fields% |title: %title% status: %status% |description: %description% |references: %references% |tags: %tags% |author: %author% |date: %date% |falsepositives: %falsepositives% |level: %level%'
        result_link: 0
        view_link: 0
        include_search: 0
        include_trigger: 0
        include_trigger_time: 0
        inline: 0
        sendcsv: 0
        sendpdf: 0
        sendresults: 0
